<!DOCTYPE html>
<html lang="en-us">
  <head>
    <title>My first post | Philipp Dombrink</title>

    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">    
<meta name="viewport" content="width=device-width,minimum-scale=1">
<meta name="description" content="">
<meta name="generator" content="Hugo 0.83.1" />


  <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">


<link rel="stylesheet" href="/css/style.css">
<link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon" />





  
    <link href="/posts/index.xml" rel="alternate" type="application/rss+xml" title="Philipp Dombrink" />
    <link href="/posts/index.xml" rel="feed" type="application/rss+xml" title="Philipp Dombrink" />
  




  </head>

  <body>
    <nav class="navigation">
	
		<a href="/"> <span class="arrow">←</span>Home</a>
	
	<a href="/posts">Archive</a>
	<a href="/tags">Tags</a>
	<a href="/about">About</a>

	

	
</nav>


    <main class="main">
      

<section id="single">
    <h1 class="title">My first post</h1>

    <div class="tip">
        <span>
          May 4, 2021 20:56
        </span>
        <span class="split">
          ·
        </span>
        <span>
          
            417 words
          
        </span>
        <span class="split">
          ·
        </span>
        <span>
          2 minute read
        </span>
    </div>

    <div class="content">
      <h1 id="discord-csgo-bot">discord-csgo-bot <a href="#discord-csgo-bot" class="anchor">🔗</a></h1><p>A simple discord bot for getting the status of a CSGO server via command</p>
<h2 id="installing">Installing <a href="#installing" class="anchor">🔗</a></h2><pre><code>python3 -m venv env
source env/bin/activate
pip3 install -r requirements.txt
</code></pre><h2 id="configuration">Configuration <a href="#configuration" class="anchor">🔗</a></h2><p>You will need to create a file named config.json in the base directory.</p>
<p><strong>server_ip:</strong> server ip<br>
<strong>server_port:</strong> server port<br>
<strong>custom_thumb:</strong> custom thumbnail path for the server status embed, leave empty if you don&rsquo;t want it<br>
<strong>token:</strong> your discord api token<br>
<strong>command_prefix:</strong> command prefix.<br>
<strong>refresh_time:</strong> how often should the bot refresh the server status in the background in seconds<br>
<strong>mm_nofity_role:</strong> the role that gets a ping whenever players start searching for matchmaking partners<br>
<strong>mm_status_reset_minutes:</strong> maximum idle time until a player stops searching automatically<br>
<strong>map_banner[list]:</strong> map banner image urls for !server embed. If a map banner is not exisiting, the embed banner will stay blank<br>
<strong>server_commands[list]:</strong> csgo server commands that are availiable</p>
<h3 id="example-config">Example config <a href="#example-config" class="anchor">🔗</a></h3><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
    <span style="color:#f92672">&#34;server_ip&#34;</span>: <span style="color:#e6db74">&#34;127.0.0.1&#34;</span>,
    <span style="color:#f92672">&#34;server_port&#34;</span>: <span style="color:#ae81ff">27015</span>,
    <span style="color:#f92672">&#34;custom_thumb&#34;</span>: <span style="color:#e6db74">&#34;https://test.com/images/test.png&#34;</span>,
    <span style="color:#f92672">&#34;token&#34;</span> : <span style="color:#e6db74">&#34;YOUR_DISCORD_API_TOKEN&#34;</span>,
    <span style="color:#f92672">&#34;command_prefix&#34;</span> : <span style="color:#e6db74">&#34;!&#34;</span>,
    <span style="color:#f92672">&#34;refresh_time&#34;</span> : <span style="color:#ae81ff">600</span>,
    <span style="color:#f92672">&#34;mm_notify_role&#34;</span>: <span style="color:#e6db74">&#34;YOUR_DISCORD_NOTIFY_ROLE&#34;</span>,
    <span style="color:#f92672">&#34;mm_status_reset_minutes&#34;</span> : <span style="color:#ae81ff">30</span>,
    <span style="color:#f92672">&#34;map_banner&#34;</span> : 
    {
        <span style="color:#f92672">&#34;de_aztec&#34;</span> : <span style="color:#e6db74">&#34;https://url.com/aztec.png&#34;</span>,
        <span style="color:#f92672">&#34;fy_pool_day&#34;</span> : <span style="color:#e6db74">&#34;https://url.com/fy_pool_day.png&#34;</span>
    },
    <span style="color:#f92672">&#34;server_commands&#34;</span>:
    {
        <span style="color:#f92672">&#34;!soundlist&#34;</span> : <span style="color:#e6db74">&#34;Lists all playable custom sounds&#34;</span>,
        <span style="color:#f92672">&#34;!admin&#34;</span> : <span style="color:#e6db74">&#34;SourceMod admin menu&#34;</span>,
        <span style="color:#f92672">&#34;!quake&#34;</span> : <span style="color:#e6db74">&#34;QuakeSounds settings&#34;</span>,
        <span style="color:#f92672">&#34;!rank&#34;</span> : <span style="color:#e6db74">&#34;Shows your rank on the server&#34;</span>,
        <span style="color:#f92672">&#34;!votemap&#34;</span> : <span style="color:#e6db74">&#34;Start a map vote&#34;</span>
    }
}
</code></pre></div><h2 id="usage">Usage <a href="#usage" class="anchor">🔗</a></h2><pre><code>python3 main.py
</code></pre><h3 id="run-as-systemd-service">run as systemd service <a href="#run-as-systemd-service" class="anchor">🔗</a></h3><p>/etc/systemd/system/discordbot.service</p>
<pre><code>[Unit]
Description=Discord csgo bot
After=syslog.target

[Service]
Type=simple
WorkingDirectory=~/discord-csgo-bot
ExecStart=~/discord-csgo-bot/env/bin/python3 ~/discord-csgo-bot
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
</code></pre><p><em>systemd need the full path to your python binary if you&rsquo;re using a venv!</em></p>
<p>Reload daemon and start service manually:</p>
<pre><code>sudo systemctl daemon-reload
sudo systemctl start discordbot.service
</code></pre><p>To make it start automatically after reboot:</p>
<pre><code>sudo systemctl enable discordbot.service
</code></pre><p>Check the current ouput of the service:</p>
<pre><code>sudo journalctl -u discordbot.service
</code></pre><h3 id="commands">Commands <a href="#commands" class="anchor">🔗</a></h3><p><strong>!server:</strong> show server info embed<br>
<strong>!ip:</strong> get connect link to server<br>
<strong>!mminfo:</strong> show currently searching players<br>
<strong>!mmsearch:</strong> enter matchmaking search queue<br>
<strong>!mmstop:</strong> exit matchmaking queue</p>
<p><p class="markdown-image">
  <img src="response.png?raw=true" alt="Response from bot"  title="response" />
</p>
<em>Respone after sending !server command</em></p>
<h2 id="common-issues">Common issues <a href="#common-issues" class="anchor">🔗</a></h2><h3 id="the-bot-is-not-responding-to-any-commands">The bot is not responding to any commands <a href="#the-bot-is-not-responding-to-any-commands" class="anchor">🔗</a></h3><p>Check the bot privileges for that channel. It has to be able to read and send messages for that particular channel</p>
<h3 id="server-is-not-showing-player-names-and-score">!server is not showing player names and score <a href="#server-is-not-showing-player-names-and-score" class="anchor">🔗</a></h3><p>Check if server cvar <code>host_players_show</code> is set to 2, otherwise all player names are hidden by the server</p>
<h3 id="the-ping-is-incorrect">The ping is incorrect <a href="#the-ping-is-incorrect" class="anchor">🔗</a></h3><p>The bot itself is pinging the server so this depends on the internet connection the bot has</p>
<h3 id="the-connect-link-is-not-doing-anything">The connect link is not doing anything <a href="#the-connect-link-is-not-doing-anything" class="anchor">🔗</a></h3><p>If you have a password protected server, for some people the password input window from steam is not focussing and pops up in the background sometimes</p>

    </div>

    
    
    

</section>


    </main>
    
    <footer id="footer">
    

    <p class="copyright">
    
       © Copyright 
       2021 
       <span class="split">
        <svg fill="#bbbbbb" width="15" height="15" version="1.1" id="heart-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">
  <path d="M13.91,6.75c-1.17,2.25-4.3,5.31-6.07,6.94c-0.1903,0.1718-0.4797,0.1718-0.67,0C5.39,12.06,2.26,9,1.09,6.75&#xA;&#x9;C-1.48,1.8,5-1.5,7.5,3.45C10-1.5,16.48,1.8,13.91,6.75z"/>
</svg>
       </span>
       
    
    </p>
    <p class="powerby">
        Powered by <a href="http://www.gohugo.io/">Hugo</a> Theme By <a href="https://github.com/nodejh/hugo-theme-cactus-plus">nodejh</a>
    </p>
</footer>

  </body>
</html>
